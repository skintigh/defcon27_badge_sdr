#reformat packets by reversinging byte order to aid in understanding CRC
import guesser

#000s,then,a,1   is that right?!??!
packets = [
[4,2,1,0,7,0,6,1,3,2,4,2,2,2,7,5,6,2,5,6,4,7,2,5,5,7,1,0,1,5,6,1,2,5,3,2,4,1,5,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,1,2,5,5, 1,4,4,0,6,1,1,1,2,4],
[4,2,1,0,7,0,6,1,3,2,4,2,2,2,7,5,2,4,0,0,2,1,6,0,5,5,2,5,3,5,6,1,2,5,3,2,4,1,5,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,1,2,5,5, 1,4,4,0,6,1,1,1,2,4],

[4,2,1,0,7,0,6,1,3,2,4,2,2,2,7,5,2,6,3,1,1,4,5,7,0,0,4,5,3,5,6,1,2,5,3,2,4,1,5,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,1,2,5,5, 1,4,4,0,6,1,1,1,6,0],

[4,2,1,0,7,0,6,1,3,2,4,2,2,2,7,5,2,6,5,4,1,7,7,6,6,7,2,5,3,5,6,1,2,5,3,2,4,1,5,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,1,2,5,5, 5,4,4,0,6,1,1,1,2,4],

[4,2,1,0,7,0,6,1,3,2,4,2,2,2,7,5,2,4,2,5,2,6,0,5,7,6,4,5,3,5,6,1,2,5,3,2,4,1,5,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,1,2,5,5, 5,4,4,0,6,1,1,1,6,0],

[2,5,2,2, 6,6,2,7, 4,4,2,4, 4,1,6,7, 0,7,3,2,           5,4,3,5, 7,0,3,6, 4,0,7,3, 0,4,1,4, 4,2,7,4, 6,2,0,2, 0,7,6,6, 1,6,4,1, 3,1,4,4, 0,7,7,3, 5,2,7,7, 7,7,7,3, 0,3,1,6, 4,4  ,0,0]


]
'''
[4,4,4,0,4,0,4,0,2,4,6,0,0,0,0,0,6,4,2,0,0,0,4,4,2,7,7,4,6,7,5,6,4,6,7,5,1,2,6,4,2,3,1,2,3,3,6,7,2,6,1,4,5,3,1,5,7,0,3,6,4,0,7,3,0,4,1,4,4,2,7,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,3,3,7,7,5,5,3,6,0,5,2,3,6,0],
[4,4,4,0,4,0,4,0,2,4,6,0,0,0,0,0,6,4,2,0,0,0,4,4,2,7,7,4,6,7,5,6,4,6,7,5,1,2,6,4,2,3,1,2,3,3,6,7,2,6,1,4,5,3,1,5,7,0,3,6,4,0,7,3,0,4,1,4,4,2,7,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,3,3,7,7,5,5,3,6,0,5,2,3,6,0],
[4,4,4,0,4,0,4,0,2,4,6,0,0,0,0,0,6,4,2,0,0,0,4,4,2,7,7,4,6,7,5,6,0,6,7,5,1,2,6,4,2,3,1,2,3,3,6,7,2,6,1,4,5,3,1,5,7,0,3,6,4,0,7,3,0,4,1,4,4,2,7,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,3,3,7,7,1,7,0,1,0,3,1,2,4,4],
[4,4,4,0,4,0,4,0,2,4,6,0,0,0,0,0,6,4,2,0,0,0,4,4,2,7,7,4,6,7,5,6,0,6,7,5,1,2,6,4,2,3,1,2,3,3,6,7,2,6,1,4,5,3,1,5,7,0,3,6,4,0,7,3,0,4,1,4,4,2,7,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,3,3,7,7,1,7,0,1,0,3,1,2,4,4],
[4,4,4,0,4,0,4,0,2,4,6,0,0,0,0,0,6,4,2,0,0,0,4,4,2,7,7,4,6,7,5,6,4,0,6,7,3,2,5,2,2,3,1,2,3,3,6,7,2,6,1,4,5,3,1,5,7,0,3,6,4,0,7,3,0,4,1,4,4,2,7,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,3,3,7,7,3,4,7,5,2,0,4,0,0,0],
[4,4,4,0,4,0,4,0,2,4,6,0,0,0,0,0,6,4,2,0,0,0,4,4,2,7,7,4,6,7,5,6,4,0,6,7,3,2,5,2,2,3,1,2,3,3,6,7,2,6,1,4,5,3,1,5,7,0,3,6,4,0,7,3,0,4,1,4,4,2,7,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,3,3,7,7,3,4,7,5,2,0,4,0,0,0],
[4,4,4,0,4,0,4,0,2,4,6,0,0,0,0,0,6,4,2,0,0,0,4,4,2,7,7,4,6,7,5,6,4,4,4,0,4,2,7,1,3,1,1,2,3,3,6,7,2,6,1,4,5,3,1,5,7,0,3,6,4,0,7,3,0,4,1,4,4,2,7,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,3,3,7,7,1,5,1,7,2,3,2,4,4,4],
[4,4,4,0,4,0,4,0,2,4,6,0,0,0,0,0,6,4,2,0,0,0,4,4,2,7,7,4,6,7,5,6,4,4,4,0,4,2,7,1,3,1,1,2,3,3,6,7,2,6,1,4,5,3,1,5,7,0,3,6,4,0,7,3,0,4,1,4,4,2,7,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,3,3,7,7,1,5,1,7,2,3,2,4,4,4],
[4,4,4,0,4,0,4,0,2,4,6,0,0,0,0,0,6,4,2,0,0,0,4,4,2,7,7,4,6,7,5,6,0,4,4,0,4,2,7,1,3,1,1,2,3,3,6,7,2,6,1,4,5,3,1,5,7,0,3,6,4,0,7,3,0,4,1,4,4,2,7,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,3,3,7,7,5,7,6,4,2,5,1,1,6,0],
[4,4,4,0,4,0,4,0,2,4,6,0,0,0,0,0,6,4,2,0,0,0,4,4,2,7,7,4,6,7,5,6,0,4,4,0,4,2,7,1,3,1,1,2,3,3,6,7,2,6,1,4,5,3,1,5,7,0,3,6,4,0,7,3,0,4,1,4,4,2,7,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,3,3,7,7,5,7,6,4,2,5,1,1,6,0],
[4,4,4,0,4,0,4,0,2,4,6,0,0,0,0,0,6,4,2,0,0,0,4,4,2,7,7,4,6,7,5,6,4,6,1,6,2,2,0,3,3,1,1,2,3,3,6,7,2,6,1,4,5,3,1,5,7,0,3,6,4,0,7,3,0,4,1,4,4,2,7,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,3,3,7,7,3,0,7,1,6,4,0,4,0,0],
[4,4,4,0,4,0,4,0,2,4,6,0,0,0,0,0,6,4,2,0,0,0,4,4,2,7,7,4,6,7,5,6,4,6,1,6,2,2,0,3,3,1,1,2,3,3,6,7,2,6,1,4,5,3,1,5,7,0,3,6,4,0,7,3,0,4,1,4,4,2,7,4,6,2,0,2,0,7,6,6,1,6,4,1,5,2,3,4,4,7,5,1,3,3,7,7,3,0,7,1,6,4,0,4,0,0]]
'''

for packet0 in packets:
	packet = [4,4,4,0,4,0,4,0,2,4,6,0,0,0,0,0,6,4,2,0,0,0,4,4,2,7,7,4,6,7,5,6] + packet0 + [0,0]
	solution = guesser.solver([0]*(8+16+2 +1), packet, debug=False, ignore=0, print_error=False, print_result=False) #in_data_orig and expected are ONLY the values to be computed, ignore sets the pos in zero_symbols
	if solution == "Impossible": print(solution)
	'''
	for x in range(8,len(solution)):
		print("{:02x}".format(solution[x]), end="")
		#print("{:02x}".format(   int('{:08b}'.format(solution[x])[::-1],2)  ), end="") #reverse bits  I think this is wrong for the hw
	print()
	'''

	#reverse byte order
	for x in range(0,4):
		for y in range(3,-1,-1):
			print("{:02x}".format(solution[8+4*x+y]), end="")
		print(end=" ")
	x = 4
	for y in range(2,-1,-1):
		print("{:02x}".format(solution[8+4*x+y]), end="")
	print()
